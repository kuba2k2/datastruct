#  Copyright (c) Kuba Szczodrzy≈Ñski 2024-10-11.

import pytest
from base import TestBase, TestData
from test_dhcp_structs import *

TEST_DATA = [
    pytest.param(
        TestData(
            data=(
                b"\x01\x01\x06\x00\x7c\x55\x73\x6a\x00\x00\x80\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xde\xad\xbe"
                b"\xef\xaa\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x63\x82\x53\x63"
                b"\x35\x01\x01\x3d\x07\x01\x00\xde\xad\xbe\xef\xaa\x0c\x07\x4b\x55"
                b"\x42\x41\x2d\x50\x43\x3c\x08\x4d\x53\x46\x54\x20\x35\x2e\x30\x37"
                b"\x0e\x01\x03\x06\x0f\x1f\x21\x2b\x2c\x2e\x2f\x77\x79\xf9\xfc\xff"
            ),
            obj_full=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REQUEST,
                hardware_type=1,
                hardware_alen=6,
                hops=0,
                transaction_id=2085974890,
                seconds_elapsed=timedelta(0),
                bootp_flags=DhcpBootpFlags.BROADCAST,
                client_ip_address=IPv4Address("0.0.0.0"),
                your_ip_address=IPv4Address("0.0.0.0"),
                server_ip_address=IPv4Address("0.0.0.0"),
                gateway_ip_address=IPv4Address("0.0.0.0"),
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
                server_host_name="",
                boot_file_name="",
                magic_cookie=b"c\x82Sc",
                options=[
                    DhcpOption(
                        option=DhcpOptionType.MESSAGE_TYPE,
                        length=1,
                        data=DhcpMessageType.DISCOVER,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.CLIENT_IDENTIFIER,
                        length=7,
                        data=DhcpClientIdentifier(
                            hardware_type=1,
                            mac_address=MAC("00-DE-AD-BE-EF-AA"),
                        ),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.HOST_NAME,
                        length=7,
                        data="KUBA-PC",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.VENDOR_CLASS_IDENTIFIER,
                        length=8,
                        data="MSFT 5.0",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.PARAMETER_REQUEST_LIST,
                        length=14,
                        data=[
                            DhcpOptionType.SUBNET_MASK,
                            DhcpOptionType.ROUTER,
                            DhcpOptionType.DNS_SERVERS,
                            DhcpOptionType.DOMAIN_NAME,
                            DhcpOptionType.PERFORM_ROUTER_DISCOVERY,
                            DhcpOptionType.STATIC_ROUTING_TABLE,
                            DhcpOptionType.VENDOR_SPECIFIC_INFORMATION,
                            DhcpOptionType.NETBIOS_NAME_SERVER,
                            DhcpOptionType.NETBIOS_NODE_TYPE,
                            DhcpOptionType.NETBIOS_SCOPE,
                            DhcpOptionType.DOMAIN_SEARCH,
                            DhcpOptionType.CLASSLESS_STATIC_ROUTE,
                            DhcpOptionType.PRIVATE_CLASSLESS_STATIC_ROUTE,
                            DhcpOptionType.PRIVATE_PROXY_AUTODISCOVERY,
                        ],
                    ),
                    DhcpOption(option=DhcpOptionType.END, length=0, data=None),
                ],
            ),
            obj_simple=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REQUEST,
                transaction_id=2085974890,
                seconds_elapsed=timedelta(0),
                bootp_flags=DhcpBootpFlags.BROADCAST,
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
                options=[
                    DhcpOption(
                        option=DhcpOptionType.MESSAGE_TYPE,
                        data=DhcpMessageType.DISCOVER,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.CLIENT_IDENTIFIER,
                        data=DhcpClientIdentifier(
                            mac_address=MAC("00-DE-AD-BE-EF-AA"),
                        ),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.HOST_NAME,
                        data="KUBA-PC",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.VENDOR_CLASS_IDENTIFIER,
                        data="MSFT 5.0",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.PARAMETER_REQUEST_LIST,
                        data=[
                            DhcpOptionType.SUBNET_MASK,
                            DhcpOptionType.ROUTER,
                            DhcpOptionType.DNS_SERVERS,
                            DhcpOptionType.DOMAIN_NAME,
                            DhcpOptionType.PERFORM_ROUTER_DISCOVERY,
                            DhcpOptionType.STATIC_ROUTING_TABLE,
                            DhcpOptionType.VENDOR_SPECIFIC_INFORMATION,
                            DhcpOptionType.NETBIOS_NAME_SERVER,
                            DhcpOptionType.NETBIOS_NODE_TYPE,
                            DhcpOptionType.NETBIOS_SCOPE,
                            DhcpOptionType.DOMAIN_SEARCH,
                            DhcpOptionType.CLASSLESS_STATIC_ROUTE,
                            DhcpOptionType.PRIVATE_CLASSLESS_STATIC_ROUTE,
                            DhcpOptionType.PRIVATE_PROXY_AUTODISCOVERY,
                        ],
                    ),
                    DhcpOption(option=DhcpOptionType.END),
                ],
            ),
        ),
        # id
        id="dhcp_discover_windows_7",
    ),
    pytest.param(
        TestData(
            data=(
                b"\x02\x01\x06\x00\x7c\x55\x73\x6a\x00\x00\x80\x00\x00\x00\x00\x00"
                b"\xc0\xa8\x00\x7a\xc0\xa8\x00\x01\x00\x00\x00\x00\x00\xde\xad\xbe"
                b"\xef\xaa\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x63\x82\x53\x63"
                b"\x35\x01\x02\x36\x04\xc0\xa8\x00\x01\x33\x04\x00\x00\xa8\xc0\x3a"
                b"\x04\x00\x00\x54\x60\x3b\x04\x00\x00\x93\xa8\x01\x04\xff\xff\xff"
                b"\x00\x1c\x04\xc0\xa8\x00\xff\x03\x04\xc0\xa8\x00\x01\x06\x04\xc0"
                b"\xa8\x00\x01\x0f\x05\x6c\x6f\x63\x61\x6c\xff"
            ),
            obj_full=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REPLY,
                hardware_type=1,
                hardware_alen=6,
                hops=0,
                transaction_id=2085974890,
                bootp_flags=DhcpBootpFlags.BROADCAST,
                client_ip_address=IPv4Address("0.0.0.0"),
                your_ip_address=IPv4Address("192.168.0.122"),
                server_ip_address=IPv4Address("192.168.0.1"),
                gateway_ip_address=IPv4Address("0.0.0.0"),
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
                server_host_name="",
                boot_file_name="",
                magic_cookie=b"c\x82Sc",
                options=[
                    DhcpOption(
                        option=DhcpOptionType.MESSAGE_TYPE,
                        length=1,
                        data=DhcpMessageType.OFFER,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.SERVER_IDENTIFIER,
                        length=4,
                        data=IPv4Address("192.168.0.1"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.IP_ADDRESS_LEASE_TIME,
                        length=4,
                        data=timedelta(seconds=43200),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.RENEW_TIME_VALUE,
                        length=4,
                        data=timedelta(seconds=21600),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.REBINDING_TIME_VALUE,
                        length=4,
                        data=timedelta(seconds=37800),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.SUBNET_MASK,
                        length=4,
                        data=IPv4Address("255.255.255.0"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.BROADCAST_ADDRESS,
                        length=4,
                        data=IPv4Address("192.168.0.255"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.ROUTER,
                        length=4,
                        data=IPv4Address("192.168.0.1"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.DNS_SERVERS,
                        length=4,
                        data=IPv4Address("192.168.0.1"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.DOMAIN_NAME,
                        length=5,
                        data="local",
                    ),
                    DhcpOption(option=DhcpOptionType.END, length=0, data=None),
                ],
            ),
            obj_simple=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REPLY,
                transaction_id=2085974890,
                bootp_flags=DhcpBootpFlags.BROADCAST,
                your_ip_address=IPv4Address("192.168.0.122"),
                server_ip_address=IPv4Address("192.168.0.1"),
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
                options=[
                    DhcpOption(
                        option=DhcpOptionType.MESSAGE_TYPE,
                        data=DhcpMessageType.OFFER,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.SERVER_IDENTIFIER,
                        data=IPv4Address("192.168.0.1"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.IP_ADDRESS_LEASE_TIME,
                        data=timedelta(seconds=43200),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.RENEW_TIME_VALUE,
                        data=timedelta(seconds=21600),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.REBINDING_TIME_VALUE,
                        data=timedelta(seconds=37800),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.SUBNET_MASK,
                        data=IPv4Address("255.255.255.0"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.BROADCAST_ADDRESS,
                        data=IPv4Address("192.168.0.255"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.ROUTER,
                        data=IPv4Address("192.168.0.1"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.DNS_SERVERS,
                        data=IPv4Address("192.168.0.1"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.DOMAIN_NAME,
                        data="local",
                    ),
                    DhcpOption(option=DhcpOptionType.END),
                ],
            ),
        ),
        # id
        id="dhcp_offer_windows_7",
    ),
    pytest.param(
        TestData(
            data=(
                b"\x01\x01\x06\x00\x9a\xe1\x6c\x9d\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xde\xad\xbe"
                b"\xef\xaa\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x63\x82\x53\x63"
                b"\x35\x01\x03\x3d\x07\x01\x00\xde\xad\xbe\xef\xaa\x32\x04\xc0\xa8"
                b"\x00\x2a\x39\x02\x05\xdc\x3c\x0f\x61\x6e\x64\x72\x6f\x69\x64\x2d"
                b"\x64\x68\x63\x70\x2d\x31\x32\x0c\x20\x55\x72\x7a\x61\x64\x7a\x65"
                b"\x6e\x69\x65\x2d\x4d\x32\x31\x2d\x75\x7a\x79\x74\x6b\x6f\x77\x6e"
                b"\x69\x6b\x61\x2d\x41\x41\x41\x41\x41\x37\x0c\x01\x03\x06\x0f\x1a"
                b"\x1c\x33\x3a\x3b\x2b\x72\x6c\xff"
            ),
            obj_full=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REQUEST,
                hardware_type=1,
                hardware_alen=6,
                hops=0,
                transaction_id=2598464669,
                seconds_elapsed=timedelta(0),
                bootp_flags=DhcpBootpFlags(0),
                client_ip_address=IPv4Address("0.0.0.0"),
                your_ip_address=IPv4Address("0.0.0.0"),
                server_ip_address=IPv4Address("0.0.0.0"),
                gateway_ip_address=IPv4Address("0.0.0.0"),
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
                server_host_name="",
                boot_file_name="",
                magic_cookie=b"c\x82Sc",
                options=[
                    DhcpOption(
                        option=DhcpOptionType.MESSAGE_TYPE,
                        length=1,
                        data=DhcpMessageType.REQUEST,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.CLIENT_IDENTIFIER,
                        length=7,
                        data=DhcpClientIdentifier(
                            mac_address=MAC("00-DE-AD-BE-EF-AA"),
                        ),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.REQUESTED_IP_ADDRESS,
                        length=4,
                        data=IPv4Address("192.168.0.42"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.MAXIMUM_MESSAGE_SIZE,
                        length=2,
                        data=1500,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.VENDOR_CLASS_IDENTIFIER,
                        length=15,
                        data="android-dhcp-12",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.HOST_NAME,
                        length=32,
                        data="Urzadzenie-M21-uzytkownika-AAAAA",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.PARAMETER_REQUEST_LIST,
                        length=12,
                        data=[
                            DhcpOptionType.SUBNET_MASK,
                            DhcpOptionType.ROUTER,
                            DhcpOptionType.DNS_SERVERS,
                            DhcpOptionType.DOMAIN_NAME,
                            DhcpOptionType.INTERFACE_MTU_SIZE,
                            DhcpOptionType.BROADCAST_ADDRESS,
                            DhcpOptionType.IP_ADDRESS_LEASE_TIME,
                            DhcpOptionType.RENEW_TIME_VALUE,
                            DhcpOptionType.REBINDING_TIME_VALUE,
                            DhcpOptionType.VENDOR_SPECIFIC_INFORMATION,
                            DhcpOptionType.DHCP_CAPTIVE_PORTAL,
                            DhcpOptionType.IPV6_ONLY_PREFERRED,
                        ],
                    ),
                    DhcpOption(option=DhcpOptionType.END, length=0, data=None),
                ],
            ),
            obj_simple=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REQUEST,
                transaction_id=2598464669,
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
                options=[
                    DhcpOption(
                        option=DhcpOptionType.MESSAGE_TYPE,
                        data=DhcpMessageType.REQUEST,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.CLIENT_IDENTIFIER,
                        data=DhcpClientIdentifier(
                            mac_address=MAC("00-DE-AD-BE-EF-AA"),
                        ),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.REQUESTED_IP_ADDRESS,
                        data=IPv4Address("192.168.0.42"),
                    ),
                    DhcpOption(
                        option=DhcpOptionType.MAXIMUM_MESSAGE_SIZE,
                        data=1500,
                    ),
                    DhcpOption(
                        option=DhcpOptionType.VENDOR_CLASS_IDENTIFIER,
                        data="android-dhcp-12",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.HOST_NAME,
                        data="Urzadzenie-M21-uzytkownika-AAAAA",
                    ),
                    DhcpOption(
                        option=DhcpOptionType.PARAMETER_REQUEST_LIST,
                        data=[
                            DhcpOptionType.SUBNET_MASK,
                            DhcpOptionType.ROUTER,
                            DhcpOptionType.DNS_SERVERS,
                            DhcpOptionType.DOMAIN_NAME,
                            DhcpOptionType.INTERFACE_MTU_SIZE,
                            DhcpOptionType.BROADCAST_ADDRESS,
                            DhcpOptionType.IP_ADDRESS_LEASE_TIME,
                            DhcpOptionType.RENEW_TIME_VALUE,
                            DhcpOptionType.REBINDING_TIME_VALUE,
                            DhcpOptionType.VENDOR_SPECIFIC_INFORMATION,
                            DhcpOptionType.DHCP_CAPTIVE_PORTAL,
                            DhcpOptionType.IPV6_ONLY_PREFERRED,
                        ],
                    ),
                    DhcpOption(option=DhcpOptionType.END),
                ],
            ),
        ),
        id="dhcp_request_android",
    ),
    pytest.param(
        TestData(
            data=(
                b"\x01\x01\x06\x00\xde\xad\xbe\xef\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xde\xad\xbe"
                b"\xef\xaa\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x63\x82\x53\x63"
                b"\xff"
            ),
            obj_full=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REQUEST,
                hardware_type=1,
                hardware_alen=6,
                hops=0,
                transaction_id=3735928559,
                seconds_elapsed=timedelta(0),
                bootp_flags=DhcpBootpFlags(0),
                client_ip_address=IPv4Address("0.0.0.0"),
                your_ip_address=IPv4Address("0.0.0.0"),
                server_ip_address=IPv4Address("0.0.0.0"),
                gateway_ip_address=IPv4Address("0.0.0.0"),
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
                server_host_name="",
                boot_file_name="",
                magic_cookie=b"c\x82Sc",
                options=[DhcpOption(option=DhcpOptionType.END, length=0, data=None)],
            ),
            obj_simple=DhcpPacket(
                packet_type=DhcpPacketType.BOOT_REQUEST,
                transaction_id=0xDEADBEEF,
                client_mac_address=MAC("00-DE-AD-BE-EF-AA"),
            ),
        ),
        id="dhcp_minimal",
    ),
]


@pytest.mark.parametrize("test", TEST_DATA)
class TestDhcp(TestBase):
    pass


del TestBase
